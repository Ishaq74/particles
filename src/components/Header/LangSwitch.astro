---
import { Button } from "@components/starwind/button";
import { Dropdown, DropdownTrigger, DropdownContent, DropdownItem, DropdownLabel, DropdownSeparator } from "@components/starwind/dropdown";
import { Icon } from "astro-icon/components";

const lang = Astro.props.lang;
const availableLangs = Astro.props.availableLangs ?? [];
const getLocalizedUrl = Astro.props.getLocalizedUrl ?? ((code: string) => `/${code}`);
---
<Dropdown>
  <DropdownTrigger asChild>
    <Button variant="ghost" size="icon" aria-label="Changer de langue">
      <Icon name={`circle-flags:${availableLangs.find(l => l.code === lang)?.flag || 'fr'}`} class="h-6 w-6" />
    </Button>
  </DropdownTrigger>
  <DropdownContent side="bottom" align="end" class="w-40 p-2">
    <DropdownLabel>Choisir une langue</DropdownLabel>
    <DropdownSeparator/>
    {availableLangs.map(target => (
      <DropdownItem as="a" href={getLocalizedUrl(target.code)} class="flex items-center justify-between">
        <span>{target.name}</span>
        <Icon name={`circle-flags:${target.flag || 'fr'}`} class="h-5 w-5" />
      </DropdownItem>
    ))}
  </DropdownContent>
</Dropdown>