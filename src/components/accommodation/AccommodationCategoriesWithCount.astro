---
import { Card, CardHeader, CardContent, CardTitle } from '@components/starwind/card';
import { Badge } from '@components/starwind/badge';
import { Icon } from 'astro-icon/components';
import { loadPlaceCategorySummaries } from '@utils/placeContent';

export interface Props {
  parentId: string;
  hebergementsSlug: string;
}

const { lang } = Astro.locals;
const { parentId, hebergementsSlug } = Astro.props as Props;

const translations = {
  fr: {
    title: 'Catégories d\'hébergements',
    empty: 'Aucune catégorie disponible.'
  },
  en: {
    title: 'Accommodation Categories',
    empty: 'No category available.'
  },
  es: {
    title: 'Categorías de Alojamiento',
    empty: 'Ninguna categoría disponible.'
  }
};
const t = translations[lang] ?? translations.fr;
const categories: Array<{ id: string; name: string; slug: string; count: number; }> = parentId
  ? await loadPlaceCategorySummaries(parentId, lang)
  : [];
---

<Card>
  <CardHeader>
    <CardTitle class="flex items-center gap-2">
      <Icon name="openmoji:bed" class="h-5 w-5" />
      {t.title}
    </CardTitle>
  </CardHeader>
  <CardContent>
    {categories.length > 0 ? (
      <ul class="space-y-2">
        {categories.map(cat => (
          <li>
            <a href={`/${lang}/${hebergementsSlug}/${cat.slug}`} class="flex justify-between items-center text-gray-600 hover:text-blue-600 font-medium p-2 -m-2 rounded-lg hover:bg-slate-50 transition-colors">
              <span>{cat.name}</span>
              <Badge variant="secondary">{cat.count}</Badge>
            </a>
          </li>
        ))}
      </ul>
    ) : (
      <div class="flex flex-col items-center py-8">
        <Icon name="openmoji:desert" class="h-16 w-16 mx-auto text-gray-400 mb-4" />
        <span class="text-gray-500 text-sm">{t.empty}</span>
      </div>
    )}
  </CardContent>
</Card>